---
include:
  default:
    - profile::monitoring::sensu::agent

location_environment: prod
location_description: Production environment in Oslo

domain_public: 'iaas.uio.no'
domain_trp:    '%{::domain}' #FIXME
domain_mgmt:   'iaas.uio.no'

netcfg_mgmt_gateway: '172.18.32.1'
netcfg_trp_gateway:  '172.18.32.1'

#
# Networks
# See http://iaas.readthedocs.io/en/latest/installation/ip.html
# For config that require network info about other network
#
network_service:    '172.19.32.0/21'
network_transport:  '172.18.32.0/19'
network_public:     '158.37.63.0/24'

endpoint_protocol: 'https'

# public
service__address__horizon:           'dashboard.iaas.uio.no'
service__address__keystone_public:   'dashboard.iaas.uio.no'
service__address__glance_public_api: 'dashboard.iaas.uio.no'
service__address__nova_public_api:   'dashboard.iaas.uio.no'
service__address__neutron_public:    'dashboard.iaas.uio.no'
service__address__cinder_public_api: 'dashboard.iaas.uio.no'
service__address__consoleproxy:      'console.iaas.uio.no'

# service/transport1
service__address__nova_api:          '172.18.32.66'
service__address__nova_api_metadata: '127.0.0.1'
service__address__glance_registry:   '172.18.32.36'
service__address__glance_api:        '172.18.32.36'
service__address__keystone:          '172.18.32.81'
service__address__keystone_admin:    '172.18.32.81'
service__address__etcd_cluster:      '172.18.32.71'
service__address__neutron_server:    '172.18.32.71'
service__address__cinder_api:        '172.18.32.46'
service__address__mysql:             '172.18.32.41'

# mgmt
service__address__proxy:             '172.16.32.12'
service__address__rsyslog:           '172.16.32.13'
mgmt_address_mq:                     '172.16.32.31'

# rabbitmq
service__address__rabbitmq_01:       '172.18.32.31'
service__address__rabbitmq_02:       '172.18.32.31'
service__address__rabbitmq_03:       '172.18.32.31'

himlar_bootstrap::nameserver: 129.240.2.3 # FIXME

ntp::servers:
  - ntp1.uio.no
  - ntp2.uio.no

ceph::profile::params::mon_initial_members:         'osl-cephmon-01, osl-cephmon-02, osl-cephmon-03'
ceph::profile::params::mon_host:                    '172.18.32.91:6789, 172.18.32.92:6789, 172.18.32.93:6789'
ceph::profile::params::cluster_network:             '172.18.32.0/21'
ceph::profile::params::public_network:              '172.18.32.0/21'

profile::openstack::volume::manage_rbd: true
profile::openstack::volume::api::enable_multibackend: true
profile::openstack::compute::hypervisor::manage_libvirt_rbd: true

# If backend != file, you must explicitly define stores in %location/modules/glance.yaml
profile::openstack::image::api::backend: 'rbd'

# sensu.yaml
sensu::rabbit_password:                  'sensu_guest'
sensu_api_password:                      'sensu'
graphite_secret_key:                     'graphite_pass'

profile::network::services::dhcp_reservation:
  osl-leaf-01:
    mac: '00:01:e8:d8:46:f3'
    ip:  '172.16.32.4'
  osl-leaf-02:
    mac: '00:01:e8:d8:38:28'
    ip:  '172.16.32.5'
  osl-leaf-03:
    mac: '00:01:e8:d8:25:9f'
    ip:  '172.16.32.6'
  osl-leaf-04:
    mac: '00:01:e8:d8:49:ff'
    ip:  '172.16.32.7'

profile::network::services::dns_options:
  CNAME:
    default:
      ttl: 3600
      keyfile: "/opt/repo/secrets/nodes/%{hostname}/etc/rndc-%{location}.key"
      server: '129.240.2.6'
  A:
    default:
      ttl: 86400
      keyfile: "/opt/repo/secrets/nodes/%{hostname}/etc/rndc-%{location}.key"
      server: '129.240.2.6'

profile::network::services::dns_records:
  CNAME:
    'admin.iaas.uio.no':                   'osl-admin-01.iaas.uio.no'
    'repo.iaas.uio.no':                    'osl-admin-01.iaas.uio.no'
    'monitor.iaas.uio.no':                 'osl-monitor-01.iaas.uio.no'
    'logger.iaas.uio.no':                  'osl-logger-01.iaas.uio.no'
    'foreman.iaas.uio.no':                 'osl-admin-01.iaas.uio.no'
  A:
    'osl-leaf-01.iaas.uio.no':        '172.16.32.4'
    'osl-leaf-02.iaas.uio.no':        '172.16.32.5'
    'osl-leaf-03.iaas.uio.no':        '172.16.32.6'
    'osl-leaf-04.iaas.uio.no':        '172.16.32.7'
    'osl-admin-01.iaas.uio.no':       '172.16.32.11'
    'puppet.iaas.uio.no':             '172.16.32.11'
    'osl-proxy-01.iaas.uio.no':       '172.16.32.12'
    'osl-logger-01.iaas.uio.no':      '172.16.32.13'
    'osl-monitor-01.iaas.uio.no':     '172.16.32.14'
    'osl-mq-01.iaas.uio.no':          '172.16.32.31'
    'osl-image-01.iaas.uio.no':       '172.16.32.36'
    'osl-db-01.iaas.uio.no':          '172.16.32.41'
    'osl-volume-01.iaas.uio.no':      '172.16.32.46'
    'osl-dashboard-01.iaas.uio.no':   '172.16.32.51'
    'osl-access-01.iaas.uio.no':      '172.16.32.56'
    'osl-console-01.iaas.uio.no':     '172.16.32.61'
    'osl-novactrl-01.iaas.uio.no':    '172.16.32.66'
    'osl-network-01.iaas.uio.no':     '172.16.32.71'
    'osl-identity-01.iaas.uio.no':    '172.16.32.81'
    'osl-cephmon-01.iaas.uio.no':     '172.16.32.91'
    'osl-cephmon-02.iaas.uio.no':     '172.16.32.92'
    'osl-cephmon-03.iaas.uio.no':     '172.16.32.93'
    'osl-controller-01.iaas.uio.no':  '172.16.32.100'
    'osl-controller-02.iaas.uio.no':  '172.16.32.101'
    'osl-controller-03.iaas.uio.no':  '172.16.32.102'
    'osl-compute-01.iaas.uio.no':     '172.16.32.103'
    'osl-compute-02.iaas.uio.no':     '172.16.32.104'
    'osl-compute-03.iaas.uio.no':     '172.16.32.105'
    'osl-storage-01.iaas.uio.no':     '172.16.32.106'
    'osl-storage-02.iaas.uio.no':     '172.16.32.107'
    'osl-storage-03.iaas.uio.no':     '172.16.32.108'
    'osl-storage-04.iaas.uio.no':     '172.16.32.109'
    'osl-storage-05.iaas.uio.no':     '172.16.32.110'
