---
network::interfaces_hash:
  'eth1':
    onboot:    'yes'
    mtu:       '1500'
    ipaddress: "%{hiera('netcfg_mgmt_netpart')}.19"
    netmask:   "%{hiera('netcfg_mgmt_netmask')}"

# disable sensuclassic
profile::monitoring::sensu::agent::enable_agent:      false
profile::monitoring::sensu::server::manage_dashboard: false
profile::monitoring::sensu::server::manage_rabbitmq:  false
profile::monitoring::sensu::server::manage_redis:     false
profile::monitoring::sensu::server::manage_graphite:  false
profile::monitoring::sensu::server::manage_firewall:  false
profile::monitoring::sensu::server::manage_resources: false
profile::messaging::rabbitmq::manage:                 false
profile::database::redis::manage:                     false
profile::base::yumrepo::repo_hash:
  sensu:
    ensure: absent
  rdo-release:
    ensure: absent
  # sensu-stable:
  #   ensure: present
  sensu-community:
    ensure: present
  yarn: #temp repo
    descr:      Yarn Repository
    baseurl:    https://dl.yarnpkg.com/rpm/
    enabled:    1
    gpgcheck:   1
    gpgkey:     https://dl.yarnpkg.com/rpm/pubkey.gpg
  nodesource: # temp repo
    descr:          Node.js Packages for Enterprise Linux 7 - $basearch
    baseurl:        https://rpm.nodesource.com/pub_14.x/el/7/$basearch
    enabled:        1
    gpgcheck:       1
    gpgkey:         https://rpm.nodesource.com/pub/el/NODESOURCE-GPG-SIGNING-KEY-EL
  uh-iaas:
    baseurl:    http://download.iaas.uio.no/uh-iaas/yumrepo/
  epel: # should be absent when using RDO, but whitelist can also work
    ensure:   present
    includepkgs: 'collectd* htop bash-completion-extras statsd python2-pip nagios-plugins-openmanage nagios-common perl-Config-Tiny perl-Crypt-DES perl-Digest* libuv perl-Net-SNMP npm python-sqlite3dbm python-tzlocal python-cairocffi'

profile::base::common::manage_sysctl: true
profile::base::common::sysctl_values:
  'fs.inotify.max_user_watches':
    value: 524288

profile::base::common::packages:
  'jq': { ensure: absent }
  'python-openstackclient': { ensure: absent }
  'openstack-selinux':      { ensure: absent }

# enable sensu go
include:
  default:
    - profile::monitoring::sensu::backend

profile::monitoring::sensu::backend::manage_dashboard:  true
profile::monitoring::sensu::backend::manage_firewall:   true
profile::monitoring::sensu::backend::manage:            true

profile::monitoring::sensu::backend::namespaces:
  '%{::location}':  { ensure: present }
