---
profile::base::common::manage_augeasproviders: true
profile::base::common::manage_epel:            false
profile::base::common::manage_accounts:        true
profile::base::common::manage_logging:         false
profile::base::common::manage_monitoring:      false
profile::base::common::manage_ssh:             true
profile::base::common::manage_ntp:             true
profile::base::common::manage_sudo:            true
profile::base::common::manage_authconfig:      false
profile::base::common::manage_timezones:       true
profile::base::common::manage_keyboard:        true
profile::base::common::manage_network:         true
profile::base::common::manage_packages:        true
profile::base::common::manage_yumrepo:         true
profile::base::common::manage_puppet:          true
profile::base::common::include_virtual:        true
profile::base::common::include_physical:       true
profile::base::firewall::manage_firewall:      true
profile::base::network::http_proxy:            "%{hiera('service__address__proxy')}:8888"
profile::base::network::http_proxy_profile:    '/root/proxy.sh'

profile::base::common::packages:
  'tcpdump': {}
  'tree': {}
  'htop': {}
  'vim-enhanced': {}
  'bind-utils': {}
  'nano': {}

profile::openstack::compute::hypervisor::manage_telemetry: false

profile::openstack::database::sql::keystone_enabled: true
profile::openstack::database::sql::glance_enabled:   true
profile::openstack::database::sql::nova_enabled:     true
profile::openstack::database::sql::neutron_enabled:  true
profile::openstack::database::sql::cinder_enabled:   true
profile::openstack::database::sql::heat_enabled:     false
profile::openstack::database::sql::trove_enabled:    false

profile::openstack::identity::ceilometer_enabled: false
profile::openstack::identity::cinder_enabled:     true
profile::openstack::identity::glance_enabled:     true
profile::openstack::identity::neutron_enabled:    true
profile::openstack::identity::nova_enabled:       true
profile::openstack::identity::swift_enabled:      false
profile::openstack::identity::trove_enabled:      false

profile::openstack::image::api::backend: 'file'

profile::openstack::network::l2_driver: calico

profile::database::mariadb::manage_repo: false

profile::application::himlarcli::username:          'admin'
profile::application::himlarcli::auth_url:          "%{hiera('endpoint_protocol')}://%{hiera('service__address__keystone_public')}:5000/v3"
profile::application::himlarcli::service_net:       "%{network_service1}/%{netmask_service1}"
profile::application::himlarcli::password:          "%{hiera('keystone_admin_password')}"
profile::application::himlarcli::region_name:       "%{::location}"
profile::application::himlarcli::tenant_name:       'openstack'
profile::application::himlarcli::default_domain:    'Default'
profile::application::himlarcli::domain:            "%{::domain}"
profile::application::himlarcli::foreman_url:       "https://%{::location}-foreman-01.%{::domain}"
profile::application::himlarcli::foreman_user:      'admin'
profile::application::himlarcli::foreman_password:  "%{hiera('foreman::admin_password')}"

profile::openstack::adminrc::auth_url:    "%{hiera('endpoint_protocol')}://%{hiera('service__address__keystone_public')}:5000/v3"
profile::openstack::adminrc::password:    "%{hiera('keystone_admin_password')}"
profile::openstack::adminrc::region_name: "%{::location}"
profile::openstack::adminrc::username:    'admin'
profile::openstack::adminrc::tenant_name: 'openstack'

# All yum repos go here
yum_base_mirror:    'http://mirror.centos.org/centos'
profile::base::yumrepo::repo_hash:
  CentOS-Base:
    descr:          'CentOS-$releasever - Base'
    baseurl:        "%{hiera('yum_base_mirror')}/$releasever/os/$basearch/"
    priority:       1
  CentOS-Updates:
    descr:          'CentOS-$releasever - Updates'
    baseurl:        "%{hiera('yum_base_mirror')}/$releasever/updates/$basearch/"
    priority:       1
  CentOS-Extras:
    descr:          'CentOS-$releasever - Extras'
    baseurl:        "%{hiera('yum_base_mirror')}/$releasever/extras/$basearch/"
    priority:       1
  puppetlabs:
    descr:          Puppetlabs Yum Repo
    baseurl:        'http://yum.puppetlabs.com/el/$releasever/products/$basearch/'
    gpgkey:         'http://yum.puppetlabs.com/RPM-GPG-KEY-puppetlabs'
    gpgcheck:       1
    priority:       20
  puppetlabs-deps:
    descr:          Puppetlabs Dependencies Yum Repo
    baseurl:        'http://yum.puppetlabs.com/el/$releasever/dependencies/$basearch/'
    gpgkey:         'http://yum.puppetlabs.com/RPM-GPG-KEY-puppetlabs'
    gpgcheck:       1
    priority:       20
  epel:
    descr:          "Extra Packages for Enterprise Linux %{operatingsystemmajrelease} - $basearch"
    metalink:       'https://mirrors.fedoraproject.org/metalink?repo=epel-7&arch=$basearch'
    gpgkey:         'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7'
    failovermethod: 'priority'
  uh-iaas:
    descr:          'UH-IaaS repo'
    baseurl:        "http://download.iaas.uio.no/uh-sky/yumrepo/"
    priority:       10
    gpgcheck:       0
# Optional repos: enable them with ensure: present in common/role
  rdo-release:
    ensure:         absent
    descr:          "OpenStack %{hiera('openstack_version')} repository"
    baseurl:        "http://mirror.centos.org/centos/7/cloud/$basearch/openstack-%{hiera('openstack_version')}/"
    enabled:        1
    gpgcheck:       1
    gpgkey:         'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-SIG-Cloud'
    priority:       98
  calico:
    ensure:         absent
    descr:          'Calico Repository'
    baseurl:        'http://binaries.projectcalico.org/rpm_stable/'
    enabled:        1
    gpgcheck:       1
    gpgkey:         'http://binaries.projectcalico.org/rpm/key'
    priority:       15
  ceph:
    ensure:         absent
    descr:          'Ceph packages'
    baseurl:        'http://download.ceph.com/rpm-hammer/el7/$basearch'
    enabled:        1
    gpgcheck:       1
    gpgkey:         'https://download.ceph.com/keys/release.asc'
    priority:       2
  ceph-noarch:
    ensure:         absent
    descr:          'Ceph noarch packages'
    baseurl:        'http://download.ceph.com/rpm-hammer/el7/noarch'
    enabled:        1
    gpgcheck:       1
    gpgkey:         'https://download.ceph.com/keys/release.asc'
    priority:       2
  logstash:
    ensure:         absent
    descr:          'Logstash Centos Repo'
    baseurl:        'http://packages.elasticsearch.org/logstash/2.3/centos'
    enabled:        1
    gpgcheck:       1
    gpgkey:         'http://packages.elasticsearch.org/GPG-KEY-elasticsearch'
    priority:       20
  elasticsearch:
    ensure:         absent
    descr:          'Elasticsearch Centos Repo'
    baseurl:        'http://packages.elastic.co/elasticsearch/2.x/centos'
    enabled:        1
    gpgcheck:       1
    gpgkey:         'http://packages.elastic.co/GPG-KEY-elasticsearch'
    priority:       20

consul::config_hash:
  'enable_syslog': true
  'bind_addr':     "%{ipaddress_mgmt1}"
